{% extends "base.html" %}

{% block content %}
<div class="d-flex align-items-center justify-content-between mb-3">
  <div>
    <h1 class="h4 fw-bold mb-1">{{ form_title }}</h1>
    <div class="text-muted small">
      Καταχώρηση/ενημέρωση προσωπικού οργανισμού και ανάθεση σε υπηρεσία (για επιλογή χειριστή στις προμήθειες).
    </div>
  </div>
  <a href="{{ url_for('admin.personnel_list') }}" class="btn btn-outline-secondary btn-sm">
    &larr; Πίσω στη λίστα
  </a>
</div>

<div class="card glass-card shadow-sm border-0">
  <div class="card-body">
    <div class="row g-3">
      <div class="col-12 col-lg-8">

        <form method="post">
          <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

          <div class="mb-2 row align-items-center">
            <label class="col-4 col-form-label col-form-label-sm">Υπηρεσία</label>
            <div class="col-8">
              <select name="service_unit_id" class="form-select form-select-sm">
                <option value="">(καμία)</option>
                {% for su in service_units %}
                  <option value="{{ su.id }}"
                    {% if person and person.service_unit_id == su.id %}selected{% endif %}>
                    {{ su.short_name or su.description }}
                  </option>
                {% endfor %}
              </select>
              <div class="form-text">
                Χρησιμοποιείται για να εμφανίζεται ως διαθέσιμος “Χειριστής” στις προμήθειες της υπηρεσίας.
              </div>
            </div>
          </div>

          <div class="mb-2 row align-items-center">
            <label class="col-4 col-form-label col-form-label-sm">ΑΓΜ *</label>
            <div class="col-8">
              <input name="agm" class="form-control form-control-sm"
                     value="{{ person.agm if person else '' }}" required>
            </div>
          </div>

          <div class="mb-2 row align-items-center">
            <label class="col-4 col-form-label col-form-label-sm">ΑΕΜ</label>
            <div class="col-8">
              <input name="aem" class="form-control form-control-sm"
                     value="{{ person.aem if person and person.aem else '' }}">
            </div>
          </div>

          <div class="mb-2 row align-items-center">
            <label class="col-4 col-form-label col-form-label-sm">Βαθμός</label>
            <div class="col-8">
              <input name="rank" class="form-control form-control-sm"
                     value="{{ person.rank if person and person.rank else '' }}">
            </div>
          </div>

          <div class="mb-2 row align-items-center">
            <label class="col-4 col-form-label col-form-label-sm">Όνομα *</label>
            <div class="col-8">
              <input name="first_name" class="form-control form-control-sm"
                     value="{{ person.first_name if person else '' }}" required>
            </div>
          </div>

          <div class="mb-2 row align-items-center">
            <label class="col-4 col-form-label col-form-label-sm">Επώνυμο *</label>
            <div class="col-8">
              <input name="last_name" class="form-control form-control-sm"
                     value="{{ person.last_name if person else '' }}" required>
            </div>
          </div>

          <div class="mb-2 row align-items-center">
            <label class="col-4 col-form-label col-form-label-sm">Ειδικότητα</label>
            <div class="col-8">
              <input name="specialty" class="form-control form-control-sm"
                     value="{{ person.specialty if person and person.specialty else '' }}">
            </div>
          </div>

          {% if person %}
          <div class="mb-2 row align-items-center">
            <label class="col-4 col-form-label col-form-label-sm">Κατάσταση</label>
            <div class="col-8">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" name="is_active" id="is_active"
                       {% if person.is_active %}checked{% endif %}>
                <label class="form-check-label" for="is_active">
                  Ενεργό Προσωπικό
                </label>
              </div>
            </div>
          </div>
          {% endif %}

          <div class="mt-3">
            <button class="btn btn-primary btn-sm">
              Αποθήκευση
            </button>
          </div>

        </form>

      </div>

      <div class="col-12 col-lg-4">
        <div class="card bg-light border-0 h-100">
          <div class="card-body py-3 small">
            <div class="fw-bold mb-2">Σημείωση</div>
            <ul class="mb-0">
              <li>Το Προσωπικό είναι master list (μόνο Admin).</li>
              <li>Η ανάθεση σε Υπηρεσία επιτρέπει φιλτράρισμα χειριστών στη “Νέα Προμήθεια”.</li>
              <li>Μπορείς να απενεργοποιήσεις προσωπικό (δεν θα εμφανίζεται ως χειριστής).</li>
            </ul>
          </div>
        </div>
      </div>

    </div>
  </div>
</div>
{% endblock %}